
<div *ngIf="loaded === 'ERROR'">
    <h2>데이터를 가져오는 도중에 문제가 발생했습니다</h2>
    <h4>잠시후 다시 시도해 주시기 바랍니다. 문제가 지속될 경우 운영 팀에 문의 바랍니다.</h4>
</div>

<div *ngIf="loaded === 'SUCCESS'">

    <div class="flex flex-nowrap w-full overflow-scroll px-3 my-5">
        <div class="w-25rem mr-3 mb-3">
            <p-card header="NASDAQ 100 목표 가격" >
                <p-chart type="line" [data]="ndxTargetChart" [options]="ndxTargetChartOption"></p-chart>
            </p-card>
        </div>

        <div class="w-25rem mr-3 mb-3">
            <p-card header="NASDAQ 100 종목별 레이팅" >
                <p-chart type="horizontalBar" [data]="ndxRatingChart" [options]="ndxRatingChartOption"></p-chart>
            </p-card>
        </div>
    
        <div class="w-25rem mr-3 mb-3">
            <p-card header="NASDAQ 100 EPS 변화">
                <p-chart type="bar" [data]="ndxEpsChart" [options]="ndxEpsChartOption" bar-></p-chart>
            </p-card>
        </div>
    
        <div class="w-25rem mr-3 mb-3">
            <p-card header="종목별 상승여력">
                <p-chart #chart type="bar" [data]="potentialChart" [options]="potentialChartOption"></p-chart>
            </p-card>
        </div>

        <div class="w-25rem mr-3 mb-3">
            <p-card header="종목별 EPS 변화">
                <p-chart type="line" [data]="epsChangeChart" [options]="epsChangeChartOption" bar-></p-chart>
            </p-card>
        </div>
    </div>
    
    <div class="section-table">
        <p-card header="NASDAQ 100 종목 데이터" >
    
            <p-table 
                #dataTable
                [value]="data" 
                selectionMode="multiple"
                [(selection)]="selectedData"
                dataKey="ticker"
                (onRowSelect)="onRowSelect($event)"
                (onRowUnselect)="onRowUnselect($event)"
                [scrollable]="true"
                scrolDirection="both"
                styleClass="p-datatable-sm"
            >
                <ng-template pTemplate="header">
                    <tr>
                        <th  
                            *ngFor="let header of headers" 
                            [ngStyle]="{'width': header.width || '8em' }"
                            [pSortableColumn]="header.value"
                        >
                            <div class="text-center">{{ header.label }}</div>
                            <div class="flex justify-content-center">
                                <p-sortIcon [field]="header.value"></p-sortIcon>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th [ngStyle]="{'width': headerMap['ticker'].width || '8em' }">NDX100</th>
                        <th *ngFor="let key of summaryHeaderKeys">{{ dataSummary[key] }}</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-data let-rowIndex="ticker">
                    <tr [pSelectableRow]="data" [pSelectableRowIndex]="rowIndex">
                        <td 
                            *ngFor="let key of dataKeys" 
                            [ngStyle]="{'width': headerMap[key].width || '8em'}"
                        >
                            {{ data[key] | ndxBookData: headerMap[key].type }}
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </p-card>
    </div>
</div>